–Ø —Ä–µ–∞–ª–∏–∑—É—é –ø—Ä–æ–µ–∫—Ç-–∫–æ–Ω—Ü–µ–ø—Ü–∏—é –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –æ–≤–µ—Ä–ª–µ–π–Ω–æ–π —Å–µ—Ç–∏ —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º —É–∫–ª–æ–Ω–æ–º –≤ —Å—Ç–æ—Ä–æ–Ω—É SD-WAN. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ VPN, –≥–¥–µ –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –∑–∞–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ –æ–¥–Ω—É —Ç—Ä—É–±—É, —è –∏—Å–ø–æ–ª—å–∑—É—é –≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ö–µ–º—É —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –∏ PBR. –¢—Ä–∞—Ñ–∏–∫ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–æ–º–∞—à–Ω–µ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞ –∏ —Ö–∞–±–∞, –≤—ã–±–∏—Ä–∞—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç.

–¢–æ–ø–æ–ª–æ–≥–∏—è —Å–µ—Ç–∏

```mermaid
graph LR
    classDef net fill:#2d3436,stroke:#fff,stroke-width:2px,color:#fff;
    classDef device fill:#6c5ce7,stroke:#fff,stroke-width:2px,color:#fff;
    classDef router fill:#0984e3,stroke:#fff,stroke-width:2px,color:#fff;

    subgraph Edge_Layer ["üè† –ö–ª–∏–µ–Ω—Ç—ã"]
        direction TB
        Mobile["üì± Mobile Clients<br/>(Roaming)"]:::device
        
        UDR7["üõ°Ô∏è Home Ubiquiti Dream Router 7<br/>(IPS/IDS)"]:::router
        
        DoH["üîí DNS-over-HTTPS<br/>(Control D)"]
        
        %% –°–≤—è–∑—å –≤–Ω—É—Ç—Ä–∏ –¥–æ–º–∞
        UDR7 --"Secure DNS"--> DoH
    end

    InternetRU(("üá∑üá∫ RU/Local Internet")):::net

    subgraph Core_Hub ["üá∑üá∫ cloud.ru"]
        direction TB
        WG_In["WireGuard Interface"]
        Routing_Engine["Smart Routing<br/>(GeoIP/Geosite)"]
        AdGuard["üö´ DNS Blackhole"]
        LB["Load Balancer"]
        
        WG_In --> Routing_Engine
        Routing_Engine --"Ad Block"--> AdGuard
        Routing_Engine --"World Traffic"--> LB
    end

    subgraph Transport_Layer ["‚òÅÔ∏è Transport Masking"]
        CDN["üåç Cloudflare CDN"]
    end

    subgraph Exit_Nodes ["üá™üá∫ Exit Nodes"]
        direction TB
        Exit1["Nginx / VPS Netherlands)"]
        Exit2["Nginx / VPS Israel"]
    end
    
    InternetGlobal(("üåê Global Internet")):::net


    Mobile == "WireGuard" ==> WG_In

    UDR7 == "WG Tunnel" ==> WG_In
    UDR7 -- "Direct Traffic (No-VPN)" --> InternetRU

    Routing_Engine -- "RU GeoIP" --> InternetRU
    
    LB -- "VLESS + XHTTP" --> CDN
    CDN --> Exit1 & Exit2
    Exit1 & Exit2 --> InternetGlobal
```

–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∑–∞—â–∏—Ç–∞

–ü–µ—Ä–∏–º–µ—Ç—Ä
Ubiquiti Dream Router 7 (UDR7): –ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–π —à–ª—é–∑ –¥–æ–º–∞ —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º PBR.
–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è: IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π VLAN –∏ –Ω–µ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–≤–µ—Ä–ª–µ–π–Ω–æ–π —Å–µ—Ç–∏.
–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã PBR UDR7 –¥–æ–ª–∂–µ–Ω –≤—ã—Å—Ç—É–ø–∞—Ç—å DNS —Å–µ—Ä–≤–µ—Ä–æ–º –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤, upstream DNS —è –∏—Å–ø–æ–ª—å–∑—É—é Control D —Å DoH. 

–ú–æ–±–∏–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —É–∑–ª—É cloud.ru –∏–∑ –ª—é–±–æ–π —Å–µ—Ç–∏.

–ê–≥—Ä–µ–≥–∞—Ü–∏—è
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —É–∑–µ–ª –≤ cloud.ru.
–ü—Ä–æ—Ç–æ–∫–æ–ª: WireGuard –≤—ã–±—Ä–∞–Ω –¥–ª—è —Å–≤—è–∑–∏ "–ö–ª–∏–µ–Ω—Ç-–•–∞–±" –∏–∑-–∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∞—Ç–∞—Ä–µ—é –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ —à—Ç–∞—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞ UDR7.
–õ–æ–≥–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:
GeoIP: RU ‚Üí Direct Connection (–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –†–§ —Ä–µ—Å—É—Ä—Å–∞–º).
Category: Ads/Trackers ‚Üí Blackhole (–†–µ–∂–µ—Ç —Ä–µ–∫–ª–∞–º—É).
Default Route ‚Üí Secure Tunnel (–í–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π —Ç—Ä–∞—Ñ–∏–∫ —É—Ö–æ–¥–∏—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ –Ω–æ–¥—ã).

–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞
–î–ª—è –ø—Ä–æ—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ DPI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è VLESS –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –º–∏–º–∫—Ä–∏–µ–π –ø–æ –æ–±—ã—á–Ω—ã–π HTTPS.
Transport: VLESS + XHTTP. –¢—Ä–∞—Ñ–∏–∫ —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ –≤–∞–ª–∏–¥–Ω—ã–µ HTTP/2 –∑–∞–ø—Ä–æ—Å—ã, –Ω–µ–æ—Ç–ª–∏—á–∏–º—ã–µ –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
CDN Cloaking: Cloudflare CDN —Å–∫—Ä—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.
Encryption: –ü–æ–ª–Ω—ã–π TLS 1.2 Handshake —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏ (–∏–º–∏—Ç–∞—Ü–∏—è –≤–µ–±-—Å–µ—Ä—Ñ–∏–Ω–≥–∞).

–ó–∞—â–∏—Ç–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∂–µ—Å—Ç–∫–∏–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏ –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö —É–∑–ª–∞—Ö.

OS & Network Level
SSH Hardening
    * –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ Ed25519 –∫–ª—é—á–∞–º (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ cloud.ru, –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å).
    * –ó–∞–ø—Ä–µ—Ç –≤—Ö–æ–¥–∞ –ø–æ–¥ `root` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ cloud.ru, –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å).
Firewall (UFW):
    * –ü–æ–ª–∏—Ç–∏–∫–∞ Default Deny Incoming (–≤–∫–ª—é—á–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
    * –†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã: HTTPS (443) –∏ UDP –ø–æ—Ä—Ç WG.
    * –î–æ—Å—Ç—É–ø –¥–æ 22 –ø–æ—Ä—Ç–∞ (SSH) –∏ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø–æ—Ä—Ç—É 3x-ui –∑–∞–∫—Ä—ã—Ç WL.
–í–∫–ª—é—á–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º `BBR` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ TCP congestion control –∏ –∑–∞—â–∏—Ç—ã –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–∏–¥–æ–≤ —Ñ–ª—É–¥–∞.

Application Level (Xray)
–°–µ—Ä–≤–∏—Å Xray –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `uuid-service` –±–µ–∑ –ø—Ä–∞–≤ `sudo` –∏ –¥–æ—Å—Ç—É–ø–∞ –∫ shell (`/sbin/nologin`).
–ü—Ä–æ–∫—Å–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (Probe Resistance). –õ—é–±–æ–π –ø–∞–∫–µ—Ç, –Ω–µ –ø—Ä–æ—à–µ–¥—à–∏–π –ø—Ä–æ–≤–µ—Ä–∫—É UUID/Auth, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–π —Å–∞–π—Ç-–∑–∞–≥–ª—É—à–∫—É (Fallback –æ—Ç–¥–∞–µ—Ç –æ—à–∏–±–∫—É).
–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã `unattended-upgrades` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ç—á–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞ –∏ –ø–∞–∫–µ—Ç–æ–≤ –û–°.

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (Infrastructure as Code) (–≤ –¥–æ—Ä–∞–±–æ—Ç–∫–µ)
–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å–≤–µ–¥–µ–Ω–∞ –∫ –º–∏–Ω–∏–º—É–º—É. –í—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–æ–¥–æ–º (Ansible).
–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–ª–µ–π–±—É–∫–∞
System Hardening: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UFW –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "Default Deny", —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx (Reverse Proxy) –∏ –ø–∞–Ω–µ–ª–∏ 3x-ui —Å —è–¥—Ä–æ–º xray.
Secrets Management: SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏ UUID –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è).

–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (–≤ —Ä–∞–±–æ—Ç–µ)
